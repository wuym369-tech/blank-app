import streamlit as st

st.title("ğŸˆé¦™é¦™èŠ±åœ’å°ˆå±¬AIèª¿é¦™å¸«")
st.write("Let's start building! For help and inspiration.")
import streamlit as st
import time
from datetime import date

# é é¢é…ç½®
st.set_page_config(page_title="Aroma's Secret Lab", layout="centered")

# --- æ ¸å¿ƒé‚è¼¯å‡½å¼ ---
def get_life_number(birthday):
    digits = "".join(filter(str.isdigit, str(birthday)))
    while len(digits) > 1:
        digits = str(sum(int(d) for d in digits))
    return digits

def get_zodiac(month, day):
    zodiac_signs = [(1, 20, "æ‘©ç¾¯åº§"), (2, 19, "æ°´ç“¶åº§"), (3, 21, "é›™é­šåº§"), (4, 20, "ç™½ç¾Šåº§"), (5, 21, "é‡‘ç‰›åº§"), (6, 22, "é›™å­åº§"), (7, 23, "å·¨èŸ¹åº§"), (8, 23, "ç…å­åº§"), (9, 23, "è™•å¥³åº§"), (10, 24, "å¤©ç§¤åº§"), (11, 23, "å¤©è åº§"), (12, 22, "å°„æ‰‹åº§"), (12, 31, "æ‘©ç¾¯åº§")]
    for m, d, sign in zodiac_signs:
        if month < m or (month == m and day <= d): return sign
    return "æ‘©ç¾¯åº§"

# --- å®Œæ•´ 16 å‹äººæ ¼ï¼šå¤šé¦™å‘³æ¨è–¦æ•¸æ“š ---
mbti_db = {
    "INTJ": {
        "title": "æ™ºåŠ›å»ºç¯‰å¸«", "intro": "ç†æ€§çš„æˆ°ç•¥å®¶ï¼Œå…§å¿ƒçµæ§‹ç²¾å¯†ã€‚",
        "top": ["è‰æœ¬ 02", "æœ¨è³ª 04", "æŸ‘æ©˜ 05", "è‰æœ¬ 01"],
        "mid": ["æœ¨è³ª 11", "æ¸…æ–° 07", "è¾›è¾£ 02", "èŠ±é¦™ 08"],
        "base": ["æœ¨è³ª 07", "æ±æ–¹ 09", "æœ¨è³ª 14", "æœ¨è³ª 10"],
        "logic": "å†·è‰²èª¿èˆ‡ç´®å¯¦æœ¨è³ªï¼Œæ’èµ·æ‚¨ä¸éš¨æ³¢é€æµçš„æ€è€ƒé«”ç³»ã€‚"
    },
    "INFP": {
        "title": "éˆé­‚èª¿è§£è€…", "intro": "æº«æŸ”ç†æƒ³ä¸»ç¾©è€…ï¼Œå°ç¾æœ‰ç¨ç‰¹å …æŒã€‚",
        "top": ["æœé¦™ 08", "æ¸…æ–° 03", "èŠ±é¦™ 11", "æŸ‘æ©˜ 04"],
        "mid": ["èŠ±é¦™ 14", "èŠ±é¦™ 05", "è‰æœ¬ 06", "æœé¦™ 02"],
        "base": ["æ±æ–¹ 05", "éºé¦™ 01", "æ±æ–¹ 04", "æœ¨è³ª 02"],
        "logic": "æŸ”å’Œæ„Ÿæ€§èŠ±é¦™ï¼Œç‚ºæ‚¨æ•æ„Ÿçš„éˆé­‚æä¾›æº«é¦¨çš„å®ˆè­·ã€‚"
    },
    "INFJ": {
        "title": "ç¥ç¥•æå€¡è€…", "intro": "ç¥ç¥•æ´å¯Ÿè€…ï¼Œè¿½æ±‚éˆé­‚æ·±è™•çš„é€£çµã€‚",
        "top": ["æ¸…æ–° 05", "è‰æœ¬ 03", "æŸ‘æ©˜ 04", "æœ¨è³ª 05"],
        "mid": ["èŠ±é¦™ 02", "æœ¨è³ª 11", "èŠ±é¦™ 09", "æ¸…æ–° 07"],
        "base": ["æ±æ–¹ 09", "æœ¨è³ª 14", "éºé¦™ 01", "æ±æ–¹ 02"],
        "logic": "ç©ºéˆèˆ‡æ²ˆéœçš„èª¿æ€§ï¼Œå…±é³´æ‚¨è¿½æ±‚çœŸç†çš„å…§åœ¨è¦–é‡ã€‚"
    },
    "ENFP": {
        "title": "ç†±æƒ…å•Ÿç™¼è€…", "intro": "å……æ»¿å¥½å¥‡å¿ƒçš„é–‹å‰µè€…ï¼Œç†±æ„›è‡ªç”±èˆ‡å‰µæ„ã€‚",
        "top": ["æŸ‘æ©˜ 01", "æœé¦™ 02", "æœé¦™ 09", "æ¸…æ–° 04"],
        "mid": ["æœé¦™ 06", "èŠ±é¦™ 15", "èŠ±é¦™ 12", "æœé¦™ 05"],
        "base": ["æ±æ–¹ 01", "æœ¨è³ª 02", "éºé¦™ 03", "æ±æ–¹ 05"],
        "logic": "è·³èºæœé¦™èˆ‡ç”œç¾åº•éŸ»ï¼Œè±¡å¾µæ‚¨æ°¸ä¸åœæ­‡çš„å‰µæ„å†’éšªã€‚"
    },
    "ISTJ": {
        "title": "å‹™å¯¦å®ˆè­·è€…", "intro": "æ³¨é‡ç´°ç¯€èˆ‡ç§©åºï¼Œèª å¯¦ä¸”å€¼å¾—ä¿¡è³´ã€‚",
        "top": ["è‰æœ¬ 01", "è‰æœ¬ 03", "æŸ‘æ©˜ 03", "æ¸…æ–° 09"],
        "mid": ["è‰æœ¬ 06", "æœ¨è³ª 12", "è¾›è¾£ 01", "èŠ±é¦™ 06"],
        "base": ["æœ¨è³ª 07", "æœ¨è³ª 09", "æ±æ–¹ 07", "æœ¨è³ª 10"],
        "logic": "æ½”æ·¨åˆ©è½çš„æ°£æ¯ï¼Œé«”ç¾æ‚¨ç´®å¯¦ã€å¯é ä¸”é«˜æ•ˆçš„åŸå‰‡ã€‚"
    },
    "ISFJ": {
        "title": "æº«æš–å®ˆè­·è€…", "intro": "ç´°è†©ç…§é¡§è€…ï¼Œæ•£ç™¼ç¶“å…¸å„ªé›…çš„è¦ªå’ŒåŠ›ã€‚",
        "top": ["æŸ‘æ©˜ 04", "æ¸…æ–° 03", "æœé¦™ 01", "èŠ±é¦™ 11"],
        "mid": ["èŠ±é¦™ 09", "èŠ±é¦™ 14", "èŠ±é¦™ 07", "è‰æœ¬ 06"],
        "base": ["éºé¦™ 01", "æœ¨è³ª 02", "æ±æ–¹ 05", "æ±æ–¹ 04"],
        "logic": "æº«æ½¤ç´”æ·¨çš„èŠ±é¦™èˆ‡éºé¦™ï¼ŒåŒ…è£¹å‡ºæ‚¨æœ€é«”è²¼çš„å®ˆè­·èƒ½é‡ã€‚"
    },
    "ENTJ": {
        "title": "æœæ–·æŒ‡æ®å®˜", "intro": "å¤©ç”Ÿé ˜å°è€…ï¼Œå…·å‚™å¼·å¤§æ„å¿—èˆ‡é è¦‹ã€‚",
        "top": ["è¾›è¾£ 02", "æŸ‘æ©˜ 01", "è‰æœ¬ 02", "æ¸…æ–° 01"],
        "mid": ["èŠ±é¦™ 12", "æœ¨è³ª 11", "è¾›è¾£ 05", "æœ¨è³ª 05"],
        "base": ["æ±æ–¹ 07", "æœ¨è³ª 07", "æœ¨è³ª 14", "æ±æ–¹ 06"],
        "logic": "æ¬Šå¨æ°£å ´èª¿æ€§ï¼Œå±•ç¾æ‚¨ç›®æ¨™æ˜ç¢ºä¸”æœæ–·ä¸ç¾ˆçš„æ°£å‹¢ã€‚"
    },
    "ENTP": {
        "title": "æ™ºæ…§è¾¯è«–å®¶", "intro": "éˆæ´»æŒ‘æˆ°è€…ï¼Œåœ¨ç¢°æ’ä¸­å°‹æ‰¾æ–°å¯èƒ½æ€§ã€‚",
        "top": ["è‰æœ¬ 04", "æŸ‘æ©˜ 03", "æ¸…æ–° 04", "è¾›è¾£ 03"],
        "mid": ["èŠ±é¦™ 08", "æœé¦™ 05", "è¾›è¾£ 01", "æ¸…æ–° 07"],
        "base": ["æœ¨è³ª 10", "æ±æ–¹ 03", "æœ¨è³ª 12", "æ±æ–¹ 02"],
        "logic": "éˆå‹•ä¸”å¯Œæœ‰å±¤æ¬¡çš„è½‰æŠ˜ï¼Œå‘¼æ‡‰æ‚¨æ•æ·è€Œå¤šè®Šçš„æ€ç¶­ã€‚"
    },
    "ENFJ": {
        "title": "é­…åŠ›ä¸»äººå…¬", "intro": "é­…åŠ›å¼•å°è€…ï¼Œå…±æƒ…åŠ›å¼·ä¸”é¼“èˆå¤§çœ¾ã€‚",
        "top": ["æŸ‘æ©˜ 02", "æœé¦™ 02", "èŠ±é¦™ 11", "æ¸…æ–° 01"],
        "mid": ["èŠ±é¦™ 15", "èŠ±é¦™ 09", "æœé¦™ 04", "èŠ±é¦™ 01"],
        "base": ["æ±æ–¹ 04", "éºé¦™ 01", "æœ¨è³ª 02", "æ±æ–¹ 05"],
        "logic": "å¤§æ°£æº«æš–çš„èª¿æ€§ï¼Œå®Œç¾è©®é‡‹æ‚¨é‚£å¤©ç”Ÿæ­£å‘çš„æ„ŸæŸ“åŠ›ã€‚"
    },
    "ESTJ": {
        "title": "ç§©åºç¸½ç¶“ç†", "intro": "å“è¶Šç®¡ç†è€…ï¼Œé‡è¦–å‚³çµ±ã€å¯¦æ•ˆèˆ‡æ•ˆç‡ã€‚",
        "top": ["è‰æœ¬ 02", "æŸ‘æ©˜ 03", "è‰æœ¬ 01", "æ¸…æ–° 05"],
        "mid": ["æœ¨è³ª 05", "æœ¨è³ª 11", "è¾›è¾£ 02", "è‰æœ¬ 06"],
        "base": ["æœ¨è³ª 09", "æœ¨è³ª 07", "æ±æ–¹ 07", "æœ¨è³ª 12"],
        "logic": "åš´è¬¹æ£®æ—èª¿ï¼Œå±•ç¾æ‚¨åœ¨ç¾å¯¦ä¸–ç•Œä¸­å»ºç«‹ç§©åºçš„æ°£å ´ã€‚"
    },
    "ESFJ": {
        "title": "ç†±æƒ…åŸ·æ”¿å®˜", "intro": "ç¤¾äº¤ç†±å¿ƒé ˜è¢–ï¼Œé—œç…§ä»–äººéœ€æ±‚ä¸”å¥½å®¢ã€‚",
        "top": ["æœé¦™ 05", "æœé¦™ 01", "æŸ‘æ©˜ 04", "èŠ±é¦™ 07"],
        "mid": ["èŠ±é¦™ 11", "èŠ±é¦™ 14", "æœé¦™ 08", "èŠ±é¦™ 09"],
        "base": ["æœ¨è³ª 04", "æ±æ–¹ 01", "éºé¦™ 01", "æ±æ–¹ 05"],
        "logic": "ç”œç¾ç¹èŠ±èˆ‡æº«æ½¤æœ¨è³ªï¼Œè®“æ‚¨èº«é‚Šçš„äººæ„Ÿåˆ°æ„›èˆ‡ç©©å®šã€‚"
    },
    "ISTP": {
        "title": "å†·éœé‘’è³å®¶", "intro": "å†·éœè¡Œå‹•æ´¾ï¼Œç†±æ„›æ¢ç´¢äº‹ç‰©çš„æœ¬è³ªçµæ§‹ã€‚",
        "top": ["æ¸…æ–° 09", "è‰æœ¬ 04", "æŸ‘æ©˜ 05", "æ¸…æ–° 04"],
        "mid": ["è‰æœ¬ 06", "è¾›è¾£ 01", "æœ¨è³ª 12", "æ¸…æ–° 07"],
        "base": ["æœ¨è³ª 12", "æœ¨è³ª 14", "æ±æ–¹ 07", "æœ¨è³ª 07"],
        "logic": "æŠ€è¡“æ„Ÿä¸”ä¹¾æ·¨çš„èª¿æ€§ï¼Œé«”ç¾æ‚¨å°ˆæ³¨ã€ä¿è½çš„å€‹äººé¢¨æ ¼ã€‚"
    },
    "ISFP": {
        "title": "è—è¡“æ¢éšªå®¶", "intro": "éˆå‹•è—è¡“å®¶ï¼Œä»¥æ•éŠ³ç›´è¦ºæ¢ç´¢ç”Ÿæ´»ç¾æ„Ÿã€‚",
        "top": ["æœé¦™ 04", "èŠ±é¦™ 05", "æ¸…æ–° 03", "æœé¦™ 02"],
        "mid": ["èŠ±é¦™ 05", "æ¸…æ–° 08", "èŠ±é¦™ 14", "æœé¦™ 06"],
        "base": ["æœ¨è³ª 04", "æ±æ–¹ 05", "éºé¦™ 01", "æœ¨è³ª 02"],
        "logic": "å¯Œæœ‰è©©æ„çš„æµå‹•æœé¦™ï¼Œå…±é³´æ‚¨å°ç¾æ„Ÿæ¥µå…¶ç´°è†©çš„æ„ŸçŸ¥ã€‚"
    },
    "ESTP": {
        "title": "ç„¡ç•ä¼æ¥­å®¶", "intro": "ç„¡ç•è¡Œå‹•æ´¾ï¼Œåœ¨æ„Ÿå®˜ä¸–ç•Œä¸­å†’éšªèˆ‡æŒ‘æˆ°ã€‚",
        "top": ["è¾›è¾£ 05", "æŸ‘æ©˜ 03", "æ¸…æ–° 04", "è‰æœ¬ 02"],
        "mid": ["æŸ‘æ©˜ 03", "è¾›è¾£ 02", "æœ¨è³ª 05", "æ¸…æ–° 02"],
        "base": ["æ±æ–¹ 07", "æœ¨è³ª 12", "æ±æ–¹ 06", "æœ¨è³ª 07"],
        "logic": "èƒ½é‡åè¶³çš„å‰èª¿èˆ‡é‡æ€§åŸºåº•ï¼Œå¥ å®šæ‚¨å‹‡å¾€ç›´å‰çš„æ ¸å¿ƒã€‚"
    },
    "ESFP": {
        "title": "é–ƒè€€è¡¨æ¼”è€…", "intro": "ç¤¾äº¤æ˜æ˜Ÿï¼Œæ¨‚è§€ä¸”å…·å‚™å¼·å¤§ç”Ÿå‘½æ„ŸæŸ“åŠ›ã€‚",
        "top": ["æœé¦™ 09", "æŸ‘æ©˜ 01", "æœé¦™ 05", "æ¸…æ–° 04"],
        "mid": ["èŠ±é¦™ 10", "èŠ±é¦™ 15", "æœé¦™ 06", "èŠ±é¦™ 11"],
        "base": ["æ±æ–¹ 01", "æ±æ–¹ 05", "éºé¦™ 03", "æ±æ–¹ 04"],
        "logic": "æ­¡æ¨‚è¯éº—çš„ç”œç¾æ°›åœï¼Œå°‡æ‚¨çš„é–ƒè€€ç¬é–“è®Šç‚ºç²¾å½©å›æ†¶ã€‚"
    },
    "INTP": {
        "title": "é‚è¼¯å­¸å®¶", "intro": "æ²‰æ€å‰µé€ å®¶ï¼Œå°çŸ¥è­˜èˆ‡é‚è¼¯æœ‰ç„¡çª®æ¸´æ±‚ã€‚",
        "top": ["è‰æœ¬ 08", "æ¸…æ–° 07", "æŸ‘æ©˜ 05", "è‰æœ¬ 03"],
        "mid": ["æ¸…æ–° 07", "è¾›è¾£ 01", "æœ¨è³ª 11", "æ¸…æ–° 05"],
        "base": ["æœ¨è³ª 14", "æ±æ–¹ 09", "æœ¨è³ª 12", "æœ¨è³ª 10"],
        "logic": "æ·±é‚ƒå†·éœçš„å±¤æ¬¡ï¼Œæ”¯æ’æ‚¨åœ¨æ™ºæ…§æµ·æ´‹ä¸­çš„æ²‰æ¾±èˆ‡æ·±æ˜ã€‚"
    }
}

# --- ä»‹é¢å‘ˆç¾ ---
st.title("ğŸ§ª Aroma's Secret")
st.subheader("AI éˆé­‚èª¿é¦™è™•æ–¹ç®‹ (å°ˆæ¥­å…¨äººæ ¼æ­£å¼ç‰ˆ)")

# 1. è¼¸å…¥å€
col1, col2 = st.columns(2)
with col1:
    birthday = st.date_input("é¸æ“‡å‡ºç”Ÿå¹´æœˆæ—¥", value=date(2000, 1, 1))
with col2:
    mbti_choice = st.selectbox("æ‚¨çš„ MBTI", list(mbti_db.keys()))

# é è¨ˆç®—è®Šé‡ï¼Œé˜²æ­¢é¡¯ç¤ºå ±éŒ¯
num = get_life_number(birthday)
zodiac = get_zodiac(birthday.month, birthday.day)
res = mbti_db.get(mbti_choice)

st.divider()

# 2. é¡¯ç¤ºæŒ‰éˆ•èˆ‡çµæœ
if st.button("ğŸ”® å•Ÿå‹• AI æ·±åº¦åˆ†æ"):
    with st.spinner("æ­£åœ¨æ¼”ç®—éˆé­‚è·¯å¾‘èˆ‡é¦™æ°£å…±æŒ¯..."):
        time.sleep(1.2)
    
    st.balloons()
    
    # éˆé­‚è§£æå€
    with st.expander("âœ¨ æŸ¥çœ‹æ‚¨çš„éˆé­‚æ•¸æ“šè§£è®€", expanded=True):
        st.write(f"### {zodiac} Â· {num}è™Ÿäºº")
        st.write(f"**äººæ ¼åŸå‹ï¼š** {res['title']} ({mbti_choice})")
        st.write(f"**æ·±åº¦å¯«ç…§ï¼š** {res['intro']}")

    # å°ˆæ¥­è™•æ–¹å¡ç‰‡
    st.markdown(f"""
    <div style="background-color: white; padding: 25px; border-radius: 20px; border: 2px solid #1a1a1a; box-shadow: 10px 10px 0px #eee;">
        <h2 style="margin:0; color: #8B4513;">ğŸ§¬ AI å°ˆæ¥­èª¿é¦™è™•æ–¹</h2>
        <hr style="border: 0.5px solid #eee;">
        
        <div style="margin-bottom: 15px;">
            <p style="font-size: 16px; font-weight: bold; color: #2C3E50;">ã€å‰èª¿å»ºè­°ã€‘</p>
            <p style="font-size: 14px; color: #555;">{", ".join(res['top'])}</p>
        </div>

        <div style="margin-bottom: 15px;">
            <p style="font-size: 16px; font-weight: bold; color: #2C3E50;">ã€ä¸­èª¿å»ºè­°ã€‘</p>
            <p style="font-size: 14px; color: #555;">{", ".join(res['mid'])}</p>
        </div>

        <div style="margin-bottom: 15px;">
            <p style="font-size: 16px; font-weight: bold; color: #2C3E50;">ã€å¾Œèª¿å»ºè­°ã€‘</p>
            <p style="font-size: 14px; color: #555;">{", ".join(res['base'])}</p>
        </div>
        
        <p style="font-size: 14px; font-style: italic; color: #888; border-top: 1px dashed #ddd; padding-top: 10px;">
            <b>èª¿é¦™ç¾å­¸å»ºè­°ï¼š</b>{res['logic']}
        </p>
    </div>
    """, unsafe_allow_html=True)

    # 3. æ¯”ä¾‹å»ºè­°
    st.write("### ğŸ§ª ç²¾æº–é…æ¯”å»ºè­° (10ml)")
    v1, v2, v3 = st.columns(3)
    v1.metric("å‰èª¿", "2.0ml")
    v2.metric("ä¸­èª¿", "3.5ml")
    v3.metric("å¾Œèª¿", "4.5ml")
    
    st.success("ğŸ’¡ æç¤ºï¼šAI æ¨è–¦å¤šé‡é¢¨å‘³ä¾›æ‚¨è©¦èï¼Œæ‚¨å¯ä»¥ç¾å ´æŒ‘é¸æœ€å–œæ­¡çš„ 1-2 æ¬¾é€²è¡Œèåˆã€‚")
    
